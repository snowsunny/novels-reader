<template lang="pug">
div(class="header")
  div(class="container mx-auto p-4 max-w-screen-lg flex flex-col")
    div(class="text-white mx-auto text-2xl font-semibold") novels-reader -&nbsp;{{sharedStore.options.version}}
    div(class="text-white mx-auto") å¯¾å¿œã‚µãƒ¼ãƒ“ã‚¹: ncode.syosetu.com, novel18.syosetu.com, kakuyomu.jp
    div(class="text-white mx-auto") ãã®ä»–: ãƒ­ãƒ¼ã‚«ãƒ«ã«ã‚ã‚‹htmlãƒ•ã‚¡ã‚¤ãƒ«, URLã«ã€Œpages-for-novels-readerã€ã‚’å«ã‚€ãƒšãƒ¼ã‚¸
div(class="container mx-auto p-4 max-w-screen-lg")
  div(class="grid md:grid-cols-2 gap-5")
    div.options(class="")
      div(class="text-lg font-semibold") éŸ³å£°è¨­å®š
      p(class="text-sm mb-3") â€»éŸ³å£°è¨­å®šã¯OSãƒ»ãƒ–ãƒ©ã‚¦ã‚¶æ¯ã«æŒ™å‹•ãŒé•ã„ã¾ã™â€¦éŸ³å£°ãŒæ­£ã—ãå†ç”Ÿã•ã‚Œãªã„å ´åˆã¯ã‚ˆã‚ŠåˆæœŸå€¤ã«è¿‘ã„å€¤ã‚’è¨­å®šã—ã¦ã¿ã¦ä¸‹ã•ã„ã€‚
      div(class="grid md:grid-cols-3 gap-4 mb-3")
        div(class="")
          .font-semibold
            | é€Ÿåº¦
            i(class="ml-1 fa-solid fa-circle-question cursor-pointer" data-tooltip-target="tooltip-rate" data-tooltip-placement="top")
            #tooltip-rate(role="tooltip" class="inline-block absolute invisible z-10 py-2 px-3 text-sm font-medium text-white bg-gray-900 rounded-lg shadow-sm opacity-0 transition-opacity duration-300 tooltip dark:bg-gray-700")
              | èª­ã¿ä¸Šã’é€Ÿåº¦ã‚’è¨­å®šå‡ºæ¥ã¾ã™ã€‚
              br
              | åˆæœŸå€¤: 1.0, æœ€å°å€¤: 0.1, æœ€å¤§å€¤: 10.0
              div(class="tooltip-arrow" data-popper-arrow)
          input(
            v-model="sharedStore.options.voice.rate"
            name="rate" type="number" step="0.01" min="0.1" max="10" placeholder="1"
            class="mt-2 bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"
          )
        div(class="")
          .font-semibold
            | ãƒ”ãƒƒãƒ
            i(class="ml-1 fa-solid fa-circle-question cursor-pointer" data-tooltip-target="tooltip-pitch" data-tooltip-placement="top")
            #tooltip-pitch(role="tooltip" class="inline-block absolute invisible z-10 py-2 px-3 text-sm font-medium text-white bg-gray-900 rounded-lg shadow-sm opacity-0 transition-opacity duration-300 tooltip dark:bg-gray-700")
              | å£°ã®é«˜ã•ã‚’è¨­å®šå‡ºæ¥ã¾ã™ã€‚
              br
              | åˆæœŸå€¤: 1.0, æœ€å°å€¤: 0, æœ€å¤§å€¤: 2.0
              div(class="tooltip-arrow" data-popper-arrow)
          input(
            v-model="sharedStore.options.voice.pitch"
            name="pitch" type="number" step="0.01" min="0" max="2" placeholder="1"
            class="mt-2 bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"
          )
        div(class="")
          .font-semibold
            | éŸ³é‡
            i(class="ml-1 fa-solid fa-circle-question cursor-pointer" data-tooltip-target="tooltip-volume" data-tooltip-placement="top")
            #tooltip-volume(role="tooltip" class="inline-block absolute invisible z-10 py-2 px-3 text-sm font-medium text-white bg-gray-900 rounded-lg shadow-sm opacity-0 transition-opacity duration-300 tooltip dark:bg-gray-700")
              | å£°ã®éŸ³é‡ã‚’è¨­å®šå‡ºæ¥ã¾ã™ã€‚
              br
              | åˆæœŸå€¤: 1.0, æœ€å°å€¤: 0, æœ€å¤§å€¤: 1.0
              div(class="tooltip-arrow" data-popper-arrow)
          input(
            v-model="sharedStore.options.voice.volume"
            name="volume" type="number" step="0.01" min="0" max="1" placeholder="1"
            class="mt-2 bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"
          )
      div(class="grid gap-4")
        div(class="")
          .font-semibold
            | ãƒœã‚¤ã‚¹è¨­å®š
            i(class="ml-1 fa-solid fa-circle-question cursor-pointer" data-tooltip-target="tooltip-voice" data-tooltip-placement="top")
            #tooltip-voice(role="tooltip" class="inline-block absolute invisible z-10 py-2 px-3 text-sm font-medium text-white bg-gray-900 rounded-lg shadow-sm opacity-0 transition-opacity duration-300 tooltip dark:bg-gray-700")
              | èª­ã¿ä¸Šã’ã«ä½¿ã†ãƒœã‚¤ã‚¹ã‚’è¨­å®šå‡ºæ¥ã¾ã™ã€‚
              br
              | â€»é¸æŠè‚¢ã®ã€Œ/ã€ä»¥é™ã¯å¯¾å¿œè¨€èªã§ã™ã€‚
              div(class="tooltip-arrow" data-popper-arrow)
          select(
            v-model="sharedStore.options.voice.typeIndex"
            name="voiceType"
            class="mt-2 bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"
          )
            option(value="-1") åˆæœŸè¨­å®šã‚’ä½¿ç”¨ã™ã‚‹
            option(v-for='voice, i in sharedStore.availableVoices' :value='i') {{ voice.name }}: {{ voice.lang }}

      div(class="mt-5 mb-2 text-lg font-semibold") è‡ªå‹•å†ç”Ÿè¨­å®š
      div(class="flex items-center mb-1")
        input(v-model="sharedStore.options.autoPlay" id="autoPlay" name="autoPlay" type="checkbox" class="w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300 focus:ring-blue-500")
        label(for="autoPlay" class="ml-2 text-gray-900 font-semibold") è‡ªå‹•ã§å†ç”Ÿã‚’å§‹ã‚ã‚‹
      div(class="flex items-center")
        input(v-model="sharedStore.options.autoMoveNext" id="autoMoveNext" name="autoMoveNext" type="checkbox" value="" class="w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300 focus:ring-blue-500")
        label(for="autoMoveNext" class="ml-2 text-gray-900 font-semibold") æ¬¡è©±ãŒã‚ã‚‹å ´åˆã€è‡ªå‹•ã§ç§»å‹•ã™ã‚‹

    div(class="")
      div(class="text-lg font-semibold") èª­ã¿ä¸Šã’æ–‡ç« è¨­å®š
      p(class="text-sm mb-3") å°èª¬ãƒšãƒ¼ã‚¸ã®èª­ã¿ä¸Šã’ç®‡æ‰€ã®è¨­å®šã§ã™ã€‚
      div(class="flex items-center mb-1")
        input(v-model="sharedStore.options.readSections.title" id="title" name="title" type="checkbox" class="w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300 focus:ring-blue-500")
        label(for="title" class="ml-2 text-gray-900 font-semibold") é¡Œå
      div(class="flex items-center mb-1")
        input(v-model="sharedStore.options.readSections.foreword" id="foreword" name="foreword" type="checkbox" value="" class="w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300 focus:ring-blue-500")
        label(for="foreword" class="ml-2 text-gray-900 font-semibold") å‰æ›¸ã
      div(class="flex items-center mb-1")
        input(v-model="sharedStore.options.readSections.body" id="body" name="body" type="checkbox" value="" class="w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300 focus:ring-blue-500")
        label(for="body" class="ml-2 text-gray-900 font-semibold") æœ¬æ–‡
      div(class="flex items-center mb-1")
        input(v-model="sharedStore.options.readSections.afterword" id="afterword" name="afterword" type="checkbox" value="" class="w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300 focus:ring-blue-500")
        label(for="afterword" class="ml-2 text-gray-900 font-semibold") å¾Œæ›¸ã

      div(class="mt-5 text-lg font-semibold") ãƒã‚¤ãƒ©ã‚¤ãƒˆè¨­å®š
      p(class="text-sm mb-3") å†ç”Ÿä¸­ã®æ®µè½ãƒã‚¤ãƒ©ã‚¤ãƒˆã‚«ãƒ©ãƒ¼ç­‰ã®è¨­å®šã§ã™ã€‚
      div(class="grid md:grid-cols-2 gap-4 mb-3")
        div(class="")
          .font-semibold
            | ãƒ†ã‚­ã‚¹ãƒˆã‚«ãƒ©ãƒ¼
            i(class="ml-1 fa-solid fa-circle-question cursor-pointer" data-tooltip-target="tooltip-text-color" data-tooltip-placement="top")
            #tooltip-text-color(role="tooltip" class="inline-block absolute invisible z-10 py-2 px-3 text-sm font-medium text-white bg-gray-900 rounded-lg shadow-sm opacity-0 transition-opacity duration-300 tooltip dark:bg-gray-700")
              | åˆæœŸå€¤: #fff
              div(class="tooltip-arrow" data-popper-arrow)
          input(
            v-model="sharedStore.options.highlight.textColor" name="textColor" type="text" placeholder="#fff"
            class="mt-2 bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"
          )
        div(class="")
          .font-semibold
            | èƒŒæ™¯ã‚«ãƒ©ãƒ¼
            i(class="ml-1 fa-solid fa-circle-question cursor-pointer" data-tooltip-target="tooltip-background-color" data-tooltip-placement="top")
            #tooltip-background-color(role="tooltip" class="inline-block absolute invisible z-10 py-2 px-3 text-sm font-medium text-white bg-gray-900 rounded-lg shadow-sm opacity-0 transition-opacity duration-300 tooltip dark:bg-gray-700")
              | åˆæœŸå€¤: #498fd9
              div(class="tooltip-arrow" data-popper-arrow)
          input(
            v-model="sharedStore.options.highlight.backgroundColor" name="backgroundColor" type="text" placeholder="#498fd9"
            class="mt-2 bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"
          )
      div(class="grid gap-4")
        div(class="flex items-center")
          input(v-model="sharedStore.options.autoScroll" id="autoScroll" name="autoScroll" type="checkbox" value="" class="w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300 focus:ring-blue-500")
          label(for="autoScroll" class="ml-2 text-gray-900 font-semibold") å†ç”Ÿç®‡æ‰€ã«è‡ªå‹•ã§ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã™ã‚‹

  div(class="mt-16")
    div(class="text-lg font-semibold") ãƒ«ãƒ“è¾æ›¸è¨­å®šã«ã¤ã„ã¦
    p(class="text-sm") å¯¾è±¡æ–‡å­—ã‚’è¨­å®šã•ã‚ŒãŸãƒ«ãƒ“ã§èª­ã¿æ›¿ãˆã‚‹è¾æ›¸ã‚’è¨­å®šå‡ºæ¥ã¾ã™ã€‚ã€Œãƒ«ãƒ“å¯¾è±¡æ–‡å­—::ãƒ«ãƒ“ã€ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã§è¨­å®šã—ã¦ä¸‹ã•ã„ã€‚è¤‡æ•°è¨­å®šã™ã‚‹å ´åˆã¯ä¸‹è¨˜ã®æ§˜ã«æ”¹è¡Œã§åŒºåˆ‡ã£ã¦ä¸‹ã•ã„ã€‚
    p(class="text-sm font-bold mb-8") â€»ãƒ«ãƒ“ã®å„ªå…ˆåº¦ã¯ã€Œç„¡è¦–ã™ã‚‹ãƒ«ãƒ“ ï¼ å°èª¬ãƒšãƒ¼ã‚¸ã®ãƒ«ãƒ“ ï¼ ãƒ¦ãƒ¼ã‚¶ãƒ¼è¾æ›¸ ï¼ å°èª¬åˆ¥è¾æ›¸ã€ã¨ãªã£ã¦ã„ã¾ã™ã€‚

    div(class="font-semibold mb-2") ãƒ¦ãƒ¼ã‚¶ãƒ¼è¾æ›¸
    pre(class="bg-gray-200 rounded-lg text-sm p-3 w-full overflow-x-auto")
      | // ãƒ¦ãƒ¼ã‚¶ãƒ¼è¾æ›¸ã‚µãƒ³ãƒ—ãƒ« --------
      | // å…ˆé ­ã«ã€Œ//ã€ã‚’ä»˜ã‘ã‚‹äº‹ã§ã€ãã®è¡Œå…¨ã¦ã‚’ã‚³ãƒ¡ãƒ³ãƒˆã«ã™ã‚‹äº‹ãŒå‡ºæ¥ã¾ã™ã€‚
      |
      | // ãƒ«ãƒ“å¯¾è±¡æ–‡å­—::ãƒ«ãƒ“
      | æœ¬æ°—::ãƒã‚¸
      | å¼·æ•µ::å‹
      |
      | // ãƒ«ãƒ“å¯¾è±¡æ–‡å­—ã«ã¯æ­£è¦è¡¨ç¾ã‚’ä½¿ã†äº‹ãŒå‡ºæ¥ã¾ã™ã€‚
      |
      | // ä¸‹è¨˜ã®ä¾‹ã¯ã€Œ*ã€ã®ã¿ã®æ–‡ã‚’ç©ºç™½ã§èª­ã¿æ›¿ãˆã¾ã™ã€‚
      | ^\*+$::
      |
      | // ä¸‹è¨˜ã®ä¾‹ã¯ã€Œå°çªã€ã®å¾Œã«ä»˜ãèª­ã¿ãŒãªã‚’ä¿å­˜ã—ã¦ã€ãã‚Œãã‚Œã€Œã“ã¥ãã€ã€Œã“ã¥ã„ã€ã€Œã“ã¥ãã€ã§èª­ã¿æ›¿ãˆã¾ã™ã€‚
      | å°çª([ãã„ã])::ã“ã¥$1
      |
      | // ä¸‹è¨˜ã®ä¾‹ã¯ã€Œçƒã€å‰ã®æ•°å­—ã‚’ä¿å­˜ã—ã¦ã€ã€Œ1ãã‚…ã†ã€ã€Œ10ãã‚…ã†ã€ã€Œ100ãã‚…ã†ã€ç­‰ã§èª­ã¿æ›¿ãˆã¾ã™ã€‚
      | (\d+)çƒ::$1ãã‚…ã†

    p(class="mt-2 text-sm") â€»æ­£è¦è¡¨ç¾ã«ã¤ã„ã¦ã‚ˆã‚Šè©³ã—ãçŸ¥ã‚ŠãŸã„æ–¹ã¯ä¸‹è¨˜ãƒªãƒ³ã‚¯ã‚’ã”å‚ç…§ä¸‹ã•ã„ã€‚
    div(class="flex mb-2")
      //- i(class="mr-2 fa-solid fa-link text-sm")
      a(
        class="hover:underline text-sm text-blue-600 visited:text-purple-600"
        href="https://developer.mozilla.org/ja/docs/Web/JavaScript/Guide/Regular_Expressions"
        target="_blank" rel="noopener noreferrer"
      ) æ­£è¦è¡¨ç¾ - JavaScript | MDN

    textarea(:value="sharedStore.user.dictionary" @input="sharedStore.user.dictionary = $event.target.value; sharedStore.saveUserDictionary()" placeholder="ã“ã“ã«ãƒ¦ãƒ¼ã‚¶ãƒ¼è¾æ›¸ã‚’è¨˜è¿°ã—ã¦ä¸‹ã•ã„ã€‚" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full h-64 p-2.5 mb-3")

    .font-semibold ç„¡è¦–ã™ã‚‹ãƒ«ãƒ“ â€»æ­£è¦è¡¨ç¾ã®ã¿ã‚’è¨˜è¿°ã—ã¦ä¸‹ã•ã„ã€‚
    p(class="text-sm")
      | å¼·èª¿è¡¨ç¾ç­‰ã§ä½¿ã‚ã‚‹ãƒ«ãƒ“ã‚’ç„¡è¦–ã™ã‚‹ç‚ºã®è¨­å®šã‚’æ­£è¦è¡¨ç¾ã§è¨˜è¿°å‡ºæ¥ã¾ã™ã€‚ä¾‹ï¼šã€Œ^ãƒ»+$ã€ã‚’è¨­å®šã™ã‚‹ã¨ã€Œãƒ»ã€ã®ã¿ã®ãƒ«ãƒ“ã‚’ç„¡è¦–ã—ã¾ã™ã€‚è¤‡æ•°è¨­å®šã™ã‚‹å ´åˆã¯ã€Œ^ãƒ»+$|^ã€+$|^ã€‚+$ã€ã®æ§˜ã«ã—ã¾ã™ã€‚
    input(
      :value="sharedStore.user.ignoreRubies"
      @input="sharedStore.user.ignoreRubies = $event.target.value; sharedStore.saveUserIgnoreRubies()"
      name="textColor" type="text" placeholder="ã“ã“ã«ç„¡è¦–ã™ã‚‹ãƒ«ãƒ“ã‚’è¨˜è¿°ã—ã¦ä¸‹ã•ã„ã€‚"
      class="mt-2 bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"
    )

  div(class="text-lg font-semibold mt-8 mb-2") å°èª¬åˆ¥è¾æ›¸
  p(class="text-sm mb-2")
    | ä¸‹è¨˜ã®ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹äº‹ã§ã€å°èª¬åˆ¥è¾æ›¸ã‚’ç·¨é›†ã™ã‚‹äº‹ãŒå‡ºæ¥ã¾ã™ã€‚å°èª¬åˆ¥è¾æ›¸ã¯ã€ã“ã®æ‹¡å¼µæ©Ÿèƒ½ã‚’æœ‰åŠ¹ã«ã—ãŸçŠ¶æ…‹ã§ã€å„å°èª¬ãƒšãƒ¼ã‚¸ã‚’é–‹ãã¨è‡ªå‹•ã§ä½œæˆã•ã‚Œã¾ã™ã€‚å°èª¬ãƒšãƒ¼ã‚¸ã®ãƒ«ãƒ“ã‚’è‡ªå‹•ã§è¾æ›¸ã«ç™»éŒ²ã™ã‚‹è¨­å®šã‚‚å‡ºæ¥ã¾ã™ã€‚
  div(class="flex items-center")
    input(v-model="sharedStore.options.autoSaveDictionary" id="autoSaveDictionary" name="autoSaveDictionary" type="checkbox" value="" class="w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300 focus:ring-blue-500")
    label(for="autoSaveDictionary" class="ml-2 text-gray-900 font-semibold") å°èª¬ã®ãƒ«ãƒ“ã‚’è‡ªå‹•ã§è¾æ›¸ã«ç™»éŒ²ã™ã‚‹
  div(v-if="sharedStore.dictionaries.length" class="grid md:grid-cols-4 gap-3 mt-3")
    div(
      v-for="dic, i in sharedStore.dictionaries"
      :key="dic.id"
      :class="`${dic.domain} and-hover flex flex-col justify-center cursor-pointer items-center text-white focus:ring-4 font-medium rounded-lg text-sm p-3.5`"
      @click="sharedStore.selectedNovelIndex = i"
    )
      p {{dic.name}}
  div(v-else class="mt-3")
    | å°èª¬åˆ¥è¾æ›¸ã®ãƒ‡ãƒ¼ã‚¿ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚å¯¾å¿œã‚µãƒ¼ãƒ“ã‚¹ã®å°èª¬ãƒšãƒ¼ã‚¸ã‚’é–‹ã„ã¦ä¸‹ã•ã„ã€‚

  #novelModal(
    v-if="sharedStore.SN"
    class="flex justify-center items-center overflow-y-auto overflow-x-hidden fixed inset-0"
    tabindex="-1"
    aria-hidden="true"
  )
    div(class="bg-slate-900/50 overflow-x-hidden fixed inset-0 z-10" @click="sharedStore.selectedNovelIndex = null")
    div(class="relative p-4 w-full max-w-2xl md:h-auto z-20")
      div(class="flex flex-col bg-white rounded-lg shadow")
        div(:class="`${sharedStore.SN.domain} rounded-t-lg p-4 flex justify-between`")
          div(:class="flex")
            p(class="text-white font-semibold") {{sharedStore.SN.name}}
            i(class="mr-2 fa-solid fa-link text-sm")
            a(
              class="text-white hover:text-white hover:underline break-all"
              :href="sharedStore.SNLink"
              target="_blank" rel="noopener noreferrer"
            )
              | {{sharedStore.SNLink}}
          i(class="ml-2 fa-solid fa-circle-xmark text-xl cursor-pointer" @click="sharedStore.selectedNovelIndex = null")
        div(class="p-4")
          textarea(:value="sharedStore.SN.raw" @input="sharedStore.SN.raw = $event.target.value; sharedStore.forceSaveDictionary()" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full h-96 p-2.5")

  div(class="text-lg font-semibold mt-16 mb-2") å„ç¨®ãƒ‡ãƒ¼ã‚¿ã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆï¼ˆæ›¸ãå‡ºã—ï¼‰ã¨ã‚¤ãƒ³ãƒãƒ¼ãƒˆï¼ˆèª­ã¿è¾¼ã¿ï¼‰
  div(class="rounded-lg shadow-lg")
    div(class="rounded-t-lg p-4 bg-sky-500 text-white font-semibold") ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
    div(class="p-4")
      | ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã™ã‚‹ãƒ‡ãƒ¼ã‚¿ã«ãƒã‚§ãƒƒã‚¯ã‚’å…¥ã‚Œã¦ã€ã€Œãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ä¸‹ã•ã„ã€‚
      br
      | ãƒ‡ãƒ¼ã‚¿(JSONå½¢å¼)ãŒã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã•ã‚Œã‚‹ã®ã§ã€ãã‚Œã‚’ã©ã“ã‹ã«ä¿å­˜ã—ã€ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ãŸã„å´ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãƒšãƒ¼ã‚¸ã§ã‚¤ãƒ³ãƒãƒ¼ãƒˆã‚’å®Ÿè¡Œã—ã¦ä¸‹ã•ã„ã€‚

      div(class="mt-3 mb-1 flex items-center")
        input(id="options" name="options" type="checkbox" v-model="exportOptions.options" class="w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300 focus:ring-blue-500")
        label(for="options" class="ml-2 text-gray-900 font-semibold") ã‚ªãƒ—ã‚·ãƒ§ãƒ³è¨­å®šï¼ˆéŸ³å£°è¨­å®šãƒ»ãƒã‚¤ãƒ©ã‚¤ãƒˆè¨­å®šãƒ»èª­ã¿ä¸Šã’æ–‡ç« è¨­å®šãƒ»è‡ªå‹•å†ç”Ÿè¨­å®šï¼‰
      div(class="mb-1 flex items-center")
        input(id="user" name="user" type="checkbox" v-model="exportOptions.user" class="w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300 focus:ring-blue-500")
        label(for="user" class="ml-2 text-gray-900 font-semibold") ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‡ãƒ¼ã‚¿ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼è¾æ›¸ãƒ»ç„¡è¦–ã™ã‚‹ãƒ«ãƒ“ï¼‰
      div(class="flex items-center")
        input(id="dictionaries" name="dictionaries" type="checkbox" v-model="exportOptions.dictionaries" class="w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300 focus:ring-blue-500")
        label(for="dictionaries" class="ml-2 text-gray-900 font-semibold") å°èª¬åˆ¥è¾æ›¸
      button(@click="onClickExportButton" type="button" class="text-white bg-sky-500 hover:bg-sky-600 focus:ring-4 focus:ring-sky-200 font-semibold rounded-lg text-sm px-5 py-2.5 mt-3") ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼
  div(class="rounded-lg shadow-lg mt-4")
    div(class="rounded-t-lg p-4 bg-orange-400 text-white font-semibold") ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
    div(class="p-4")
      | ä¸‹è¨˜ã®ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ã«ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’è²¼ã‚Šä»˜ã‘ã¦ã€ã€Œãƒ‡ãƒ¼ã‚¿ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹ã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ä¸‹ã•ã„ã€‚
      br
      | ã‚¤ãƒ³ãƒãƒ¼ãƒˆå¾Œã«ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãƒšãƒ¼ã‚¸ãŒè‡ªå‹•æ›´æ–°ã•ã‚Œã¾ã™ã€‚
      div(class="text-rose-500 font-semibold")
        | â€»æ—¢å­˜ã®ãƒ‡ãƒ¼ã‚¿ï¼ˆæ—¢å­˜ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚„å°èª¬åˆ¥è¾æ›¸ç­‰ï¼‰ãŒã‚ã‚‹å ´åˆã¯ä¸Šæ›¸ãã•ã‚Œã‚‹ã®ã§ã€ã”æ³¨æ„ä¸‹ã•ã„ã€‚
        br
        | â€»ãƒœã‚¤ã‚¹è¨­å®šã«é–¢ã—ã¦ã§ã™ãŒã€Œã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ãŸOSã¨é•ã†OSã«ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹å ´åˆã€ã¯ãƒœã‚¤ã‚¹å/å¯¾å¿œè¨€èªãŒå¤‰ã‚ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã®ã§ã€ã‚¤ãƒ³ãƒãƒ¼ãƒˆå¾Œã¯å¿…ãšç¢ºèªã™ã‚‹ã‚ˆã†ã«ã—ã¦ä¸‹ã•ã„ã€‚

      div(class="mt-3 mb-1 flex items-center")
        input(id="newRubiesOnly" name="newRubiesOnly" type="checkbox" v-model="importOptions.newRubiesOnly" class="w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300 focus:ring-blue-500")
        label(for="newRubiesOnly" class="ml-2 text-gray-900 font-semibold") ãƒ¦ãƒ¼ã‚¶ãƒ¼è¾æ›¸ãƒ»å°èª¬åˆ¥è¾æ›¸ã¯ãƒ‡ãƒ¼ã‚¿ã‚’æ®‹ã—ã€æ—¢å­˜ã®è¾æ›¸ã«ç„¡ã„ãƒ«ãƒ“ã®ã¿ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹
      div(class="mb-1 flex items-center")
        input(id="oldVersion" name="oldVersion" type="checkbox" v-model="importOptions.oldVersion" class="w-4 h-4 text-blue-600 bg-gray-100 rounded border-gray-300 focus:ring-blue-500")
        label(for="oldVersion" class="ml-2 text-gray-900 font-semibold") ãƒãƒ¼ã‚¸ãƒ§ãƒ³1.xç³»ã®ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹
      textarea(v-model="importOptions.importDataJson" placeholder="ã“ã“ã«ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’è²¼ã‚Šä»˜ã‘ã¦ä¸‹ã•ã„ã€‚" class="bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full h-64 p-2.5 mt-3")
      div(v-if="importOptions.jsonError" class="mt-4 bg-red-100 rounded-lg p-3")
        | âš  ã‚¤ãƒ³ãƒãƒ¼ãƒˆã«å¤±æ•—ã—ã¾ã—ãŸã€‚ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’ãã®ã¾ã¾è²¼ã‚Šä»˜ã‘ã‚‹ã‹ã€ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ãŸãƒ‡ãƒ¼ã‚¿ã‚’ç·¨é›†ã—ã¦ã„ã‚‹å ´åˆã¯æ­£ã—ã„JSONå½¢å¼ã«ä¿®æ­£ã—ã¦ä¸‹ã•ã„ã€‚ğŸ™ˆ
      button(@click="onClickImportButton" type="button" class="text-white bg-orange-400 hover:bg-orange-500 focus:ring-4 focus:ring-orange-200 font-semibold rounded-lg text-sm px-5 py-2.5 mt-4") ãƒ‡ãƒ¼ã‚¿ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹
</template>

<script setup>
import { onMounted, reactive } from 'vue'
// import { Button } from 'flowbite-vue'
import useSharedStore from '../stores/shared'

const sharedStore = useSharedStore()
const onSubscribe = (mutation, state) => {
  // IDEA: ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã¨è¾æ›¸ã‚’ã“ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§æ¯å›ä¿å­˜ã§ã‚‚è‰¯ã„ã‹ãªï¼Ÿ Storeã‚’opt,dicã§åˆ†ã‘ãŸæ–¹ãŒè‰¯ã„ï¼Ÿ
  sharedStore.saveOptions()
}
let unsubscribeStore = sharedStore.$subscribe(onSubscribe)

const exportOptions = reactive({
  options: false,
  user: false,
  dictionaries: false
})
async function onClickExportButton() {
  const exportData = {}
  if(exportOptions.options) {
    exportData.options = sharedStore.options
  }
  if(exportOptions.user) {
    exportData.user = sharedStore.user
  }
  if(exportOptions.dictionaries) {
    exportData.dictionaries = sharedStore.dictionaries
  }
  await navigator.clipboard.writeText(JSON.stringify(exportData))
}

const importOptions = reactive({
  newRubiesOnly: false,
  oldVersion: false,
  importDataJson: null,
  jsonError: false
})
async function onClickImportButton() {
  try {
    importOptions.jsonError = false

    await unsubscribeStore()
    const importData = JSON.parse(importOptions.importDataJson)
    await sharedStore.importData(importData, importOptions.newRubiesOnly, importOptions.oldVersion)
    unsubscribeStore = await sharedStore.$subscribe(onSubscribe)
  } catch (error) {
    console.log(error)
    importOptions.jsonError = true
  }
}

onMounted(async () => {
  // ã“ã“ã§flowbiteã‚’èª­ã¿è¾¼ã‚€æ§˜ã«ã™ã‚‹ã¨æœ€åˆã®Modalã¯å‡ºã‚‹æ§˜ã«ãªã‚‹ã‘ã©ã€ãã®å¾Œä¸Šæ‰‹ãè¡¨ç¤ºå‡ºæ¥ãªã„â€¦ã¾ãå…¨éƒ¨Vueã§ç®¡ç†ã—ãŸæ–¹ãŒè‰¯ã„ã‹ã£ã¦æ„Ÿã˜ã€‚
  // flowbite-vueã«æœŸå¾…ã€‚æ—¢ã«Modalã¯ã‚ã‚‹ã‘ã©ã‚½ãƒ¼ã‚¹è¦‹ã¦ã‚‚ã¾ã ã¡ã‚ƒã‚“ã¨ä½¿ãˆãªã„ã¿ãŸã„â€¦ https://github.com/themesberg/flowbite-vue/tree/main/src/components
  await import('flowbite')
  document.querySelectorAll('[data-tooltip-target]').forEach(triggerEl => {
    const targetEl = document.getElementById(triggerEl.getAttribute('data-tooltip-target'))
    const triggerType = triggerEl.getAttribute('data-tooltip-trigger');
    const placement = triggerEl.getAttribute('data-tooltip-placement');

    new Tooltip(targetEl, triggerEl)
  })
})

window.addEventListener('focus', async () => {
  await sharedStore.init()
})
</script>